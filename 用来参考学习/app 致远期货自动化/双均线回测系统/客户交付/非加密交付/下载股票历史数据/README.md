# 股票数据分析系统 - 使用说明

## 项目概述

这是一个基于Python开发的股票数据分析系统，集成了BaoStock数据接口，提供完整的A股历史数据采集、存储和分析功能。系统采用Tkinter GUI界面，支持多周期K线数据分析和成交量分析。

## 主要功能

### 1. 数据采集功能
- **自动数据采集**：支持日线、周线、月线数据自动采集
- **数据合成**：自动合成季度和年度K线数据
- **流通股本获取**：自动获取历史流通股本数据
- **换手率计算**：基于流通股本计算准确的换手率
- **增量更新**：支持数据补全和更新，避免重复采集

### 2. 数据分析功能
- **K线分析**：分析指定时间段内的最高/最低收盘价
- **成交量分析**：支持多周期成交量合计和换手率分析
- **价格比例分析**：计算最高价与最低价的比例关系

### 3. 用户界面功能
- **实时进度显示**：进度条和状态标签
- **日志监控**：实时显示数据采集过程
- **多页面显示**：K线分析和成交量分析分页显示
- **自动页面切换**：点击分析按钮自动切换到对应页面

## 系统要求

### 软件环境
- Python 3.7+
- Windows 10/11 (推荐)

### 必需Python包
```bash
pip install baostock pandas sqlite3 tkinter tkcalendar matplotlib
```

### 安装依赖包
运行项目中的安装脚本：
```bash
python install_requirements.py
```

## 安装和启动

### 1. 下载项目文件
确保以下文件在同一目录下：
- `stock_analysis_gui.py` (主程序)
- `baostock_complete_data_collector_v2.py` (数据采集器)
- `install_requirements.py` (依赖安装脚本)

### 2. 安装依赖
```bash
python install_requirements.py
```

### 3. 启动程序
```bash
python stock_analysis_gui.py
```

## 使用指南

### 第一步：启动程序
1. 运行 `stock_analysis_gui.py`
2. 程序启动后会显示主界面
3. 界面分为三个主要区域：
   - 左侧：数据输入区域
   - 右侧：分析结果显示区域
   - 底部：数据采集日志区域

### 第二步：数据采集
1. **输入股票代码**
   - 在"股票代码"输入框中输入股票代码
   - 格式：`sh.600000` (上海) 或 `sz.000001` (深圳)
   - 示例：`sh.600030` (中信证券)

2. **点击查询按钮**
   - 点击"查询"按钮开始数据采集
   - 系统会自动：
     - 连接BaoStock数据接口
     - 检查本地数据库是否存在
     - 采集/更新所有周期数据
     - 合成季度和年度数据

3. **监控采集进度**
   - 查看进度条了解当前进度
   - 观察状态标签了解连接状态
   - 在底部日志框中查看详细过程

### 第三步：K线数据分析
1. **设置分析时间范围**
   - 选择"开始日期"和"结束日期"
   - 使用日历控件选择具体日期

2. **执行K线分析**
   - 点击"分析K线数据"按钮
   - 系统自动切换到"K线分析"页面
   - 显示分析结果，包括：
     - K线数量统计
     - 最高收盘价信息（日期、价格、成交量等）
     - 最低收盘价信息
     - 价格比例分析

### 第四步：成交量分析
1. **选择分析周期**
   - 勾选需要分析的周期（日线、周线、月线、季线、年线）
   - 支持多选，可同时分析多个周期

2. **执行成交量分析**
   - 点击"分析成交量数据"按钮
   - 系统自动切换到"成交量分析"页面
   - 显示每个选中周期的：
     - 成交量合计
     - 换手率

## 界面说明

### 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│                    股票数据分析系统                          │
├─────────────────┬─────────────────────────────────────────┤
│   数据输入区域   │          分析结果区域                   │
│                 │                                       │
│ 股票代码: [___] │  [K线分析] [成交量分析]                │
│ 状态: 未连接    │                                       │
│ [进度条]        │                                       │
│ 开始日期: [___] │                                       │
│ 结束日期: [___] │                                       │
│ [分析K线数据]   │                                       │
│ 选择周期:       │                                       │
│ ☑日线 ☐周线    │                                       │
│ ☐月线 ☐季线    │                                       │
│ ☐年线          │                                       │
│ [分析成交量数据] │                                       │
└─────────────────┴─────────────────────────────────────────┤
│                    数据采集日志                            │
│  [时间戳] 正在连接BaoStock...                            │
│  [时间戳] BaoStock登录成功                               │
│  [时间戳] 正在获取数据...                                │
│  [清空日志]                                              │
└─────────────────────────────────────────────────────────────┘
```

### 状态说明
- **状态标签颜色**：
  - 红色：未连接或连接失败
  - 橙色：正在连接或采集数据
  - 绿色：连接成功或操作完成

- **进度条**：
  - 0%：初始状态
  - 10%：正在连接BaoStock
  - 20%：连接成功，开始数据采集
  - 100%：数据采集完成

### 日志信息
底部日志框显示所有数据采集过程的详细信息，包括：
- 连接状态
- 数据获取进度
- 数据保存信息
- 错误信息（如有）

## 数据说明

### 数据库结构
系统会在 `gupiao_lssj` 文件夹下为每只股票创建独立的数据库文件：
- 文件名格式：`{股票代码}_complete_data.db`
- 包含以下数据表：
  - `daily_data`：日线数据
  - `weekly_data`：周线数据
  - `monthly_data`：月线数据
  - `quarterly_data`：季度数据（合成）
  - `yearly_data`：年度数据（合成）

### 数据字段
每个数据表包含以下主要字段：
- `date`：日期
- `code`：股票代码
- `open`：开盘价
- `high`：最高价
- `low`：最低价
- `close`：收盘价
- `volume`：成交量
- `amount`：成交额
- `turnover_rate`：换手率（季度/年度数据）
- `circulating_shares`：流通股本（季度/年度数据）

## 常见问题

### Q1: 程序启动失败
**A**: 检查Python环境和依赖包是否正确安装
```bash
python --version
pip list | grep baostock
```

### Q2: 数据采集失败
**A**: 
1. 检查网络连接
2. 确认股票代码格式正确
3. 查看底部日志框的错误信息

### Q3: 分析结果为空
**A**: 
1. 确认已成功采集数据
2. 检查选择的时间范围是否正确
3. 确认股票代码输入正确

### Q4: 进度条卡住
**A**: 
1. 检查网络连接
2. 等待一段时间（数据采集需要时间）
3. 查看日志框了解具体进度

### Q5: 数据库文件位置
**A**: 数据库文件保存在程序目录下的 `gupiao_lssj` 文件夹中

## 技术特点

### 1. 模块化设计
- 数据采集器和GUI界面分离
- 便于维护和功能扩展

### 2. 多线程处理
- 数据采集在后台线程进行
- 界面保持响应，不会卡顿

### 3. 错误处理
- 完善的异常捕获机制
- 详细的错误信息提示

### 4. 数据完整性
- 使用 `INSERT OR REPLACE` 确保数据不重复
- 自动表结构更新

### 5. 用户友好
- 实时进度显示
- 详细的操作日志
- 直观的界面设计

## 更新日志

### v1.0.0 (当前版本)
- 集成BaoStock数据接口
- 实现完整的数据采集功能
- 添加K线分析和成交量分析
- 实现GUI界面和实时日志显示
- 支持多周期数据分析和换手率计算

## 联系支持

如有问题或建议，请查看项目文档或联系技术支持。

---

**注意**：本系统仅供学习和研究使用，不构成投资建议。投资有风险，入市需谨慎。 