# Tradestation 自动化交易策略系统使用指南

## 🎯 项目概述

这是一个基于Tradestation平台的自动化交易策略系统，目前已完成第一阶段开发。系统支持OAuth2认证，提供完整的数据获取、处理、存储和可视化功能。

## 📋 系统要求

- Python 3.8+
- Windows 10/11
- 网络连接
- Tradestation账户

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 系统测试
```bash
python test_system.py
```

### 3. 初始化数据库
```bash
python main.py init
```

### 4. 启动Web界面
```bash
streamlit run app/ui/main.py --server.port 8501
```

### 5. 访问系统
在浏览器中打开: http://localhost:8501

## 🔐 OAuth2认证流程

Tradestation使用OAuth2认证，需要以下步骤：

### 方法1：使用认证助手（推荐）
```bash
python auth_helper.py
```

### 方法2：手动认证
1. 运行认证助手脚本
2. 选择"进行OAuth认证"
3. 浏览器会自动打开Tradestation登录页面
4. 登录并授权应用
5. 复制授权码到终端
6. 系统自动完成认证

## 📊 API功能说明

### 市场数据功能
- **获取交易品种列表**: 支持按交易所筛选
- **获取K线数据**: 支持多种时间周期（1分钟到1天）
- **获取即时价格**: 实时报价信息

### 账户管理功能
- **账户列表**: 获取所有可用账户
- **账户信息**: 查看账户基本信息
- **资金查询**: 查看账户余额
- **持仓查询**: 查看当前持仓
- **订单查询**: 查看历史订单

### 交易功能
- **市价交易**: 买入、卖出、平仓
- **限价交易**: 设置价格限制
- **做多做空**: 支持双向交易
- **自动平仓**: 智能平仓功能

## 🎨 用户界面功能

### 主界面
- **品种选择**: 左侧控制面板选择交易品种
- **时间周期**: 选择K线时间周期
- **数据范围**: 设置历史数据天数
- **实时刷新**: 手动刷新数据

### 数据可视化
- **K线图**: 显示价格走势
- **技术指标**: RSI、MACD、布林带等
- **成交量**: 成交量柱状图
- **移动平均线**: MA5、MA20、MA50

### 数据管理
- **数据统计**: 显示数据概览
- **数据下载**: 导出CSV格式
- **缓存管理**: 自动缓存优化

## 🔧 配置说明

### API配置
```python
# app/core/config.py
tradestation_api_key = "你的API密钥"
tradestation_secret = "你的API密钥"
```

### 数据库配置
```python
# 默认使用SQLite
database_url = "sqlite:///./tradestation.db"
```

### 缓存配置
```python
# Redis缓存（可选）
redis_url = "redis://localhost:6379"
```

## 📁 项目结构

```
tradestation_project/
├── app/
│   ├── api/           # API接口
│   ├── core/          # 核心配置
│   ├── data/          # 数据处理模块
│   ├── models/        # 数据模型
│   ├── services/      # 业务逻辑
│   └── ui/            # 用户界面
├── config/            # 配置文件
├── tests/             # 测试文件
├── docs/              # 文档
├── main.py            # 主程序入口
├── auth_helper.py     # OAuth认证助手
└── test_system.py     # 系统测试
```

## 🛠️ 开发指南

### 添加新的API功能
1. 在 `app/services/tradestation_client.py` 中添加新方法
2. 在 `app/data/processor.py` 中添加数据处理逻辑
3. 在 `app/ui/main.py` 中添加UI界面

### 添加新的技术指标
1. 在 `app/data/processor.py` 的 `calculate_technical_indicators` 方法中添加
2. 在UI界面中添加相应的图表显示

### 自定义配置
1. 修改 `app/core/config.py` 中的配置项
2. 创建 `.env` 文件覆盖默认配置

## 🐛 故障排除

### 常见问题

1. **OAuth认证失败**
   - 检查API密钥是否正确
   - 确认网络连接正常
   - 重新运行认证流程

2. **数据库错误**
   - 运行 `python main.py init` 重新初始化
   - 检查数据库文件权限

3. **界面无法访问**
   - 确认Streamlit已正确安装
   - 检查端口8501是否被占用
   - 尝试使用其他端口

4. **Redis连接失败**
   - 系统会自动降级到内存缓存
   - 不影响核心功能使用

### 日志查看
系统日志保存在 `logs/tradestation.log` 文件中。

## 📈 下一步开发计划

### 第二阶段：MSS引擎与FVG计算
- 实现Market Structure Shift算法
- 实现Fair Value Gap计算
- 技术指标图表显示

### 第三阶段：策略自动化控制与执行
- 策略回测功能
- 买卖点识别
- 自动化交易执行

### 第四阶段：系统集成与优化
- 性能优化
- 监控和日志系统
- 部署和运维

## 📞 技术支持

如有问题，请查看：
- 开发备忘录.md
- 使用说明.md
- 系统测试结果

## 📄 许可证

本项目仅供学习和研究使用。

---
**版本**: 1.0.0  
**更新日期**: 2024年  
**开发状态**: 第一阶段完成
