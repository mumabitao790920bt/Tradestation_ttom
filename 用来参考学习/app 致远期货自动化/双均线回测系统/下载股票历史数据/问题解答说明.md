# BaoStock API 问题解答说明

## 问题1：季度K线和年K线数据没有采集到

### 原因分析
根据BaoStock API结构化文档，`query_history_k_data_plus`函数的`frequency`参数只支持以下值：

- `d` = 日k线
- `w` = 周k线  
- `m` = 月k线
- `5` = 5分钟
- `15` = 15分钟
- `30` = 30分钟
- `60` = 60分钟

**重要发现：BaoStock API并不支持季度(`q`)和年(`y`)K线数据！**

### 解决方案
我已经创建了修正版的数据采集脚本 `baostock_data_collector_fixed.py`，移除了不支持的季度和年K线配置。

### 数据范围说明
根据API文档，BaoStock支持的数据范围：
- **日、周、月K线**：1990-12-19至今
- **分钟K线**：2019-01-02至今（近5年）

## 问题2：选择3获取股票代码列表报错

### 问题原因
原脚本中的错误处理不够完善，可能导致网络连接问题或API调用失败时程序崩溃。

### 解决方案
在修正版脚本中：
1. 添加了完整的异常处理
2. 改进了错误信息输出
3. 增加了网络连接检查
4. 优化了API调用逻辑

### 使用方法
```bash
python baostock_data_collector_fixed.py
# 选择3：仅获取股票代码列表
```

## 问题3：复权数据说明

### BaoStock API复权参数详解

根据API文档，`adjustflag`参数控制复权类型：

- `"1"` = 后复权
- `"2"` = 前复权  
- `"3"` = 不复权

### 复权数据说明

#### 1. 不复权数据 (`adjustflag="3"`)
- **特点**：原始价格数据，未经过除权除息调整
- **用途**：适合技术分析，反映真实的价格变动
- **缺点**：在除权除息日会出现价格跳空

#### 2. 前复权数据 (`adjustflag="2"`)
- **特点**：以当前价格为基准，向前调整历史价格
- **用途**：适合分析当前价格相对于历史价格的位置
- **优点**：当前价格保持不变，历史价格被调整

#### 3. 后复权数据 (`adjustflag="1"`)
- **特点**：以历史价格为基准，向后调整当前价格
- **用途**：适合分析历史价格走势
- **优点**：历史价格保持不变，当前价格被调整

### 当前脚本设置
我们的数据采集脚本使用 `adjustflag="3"`（不复权），原因：
1. 保持数据的原始性
2. 便于进行技术分析
3. 避免复权算法带来的数据偏差

### 如果需要复权数据
如果需要前复权或后复权数据，可以修改脚本中的 `adjustflag` 参数：

```python
# 前复权
adjustflag="2"

# 后复权  
adjustflag="1"

# 不复权（当前设置）
adjustflag="3"
```

## 修正后的数据采集脚本特点

### 1. 支持的数据类型
- ✅ 日线数据 (`d`)
- ✅ 周线数据 (`w`) 
- ✅ 月线数据 (`m`)
- ❌ 季度数据 (API不支持)
- ❌ 年线数据 (API不支持)

### 2. 改进的错误处理
- 网络连接异常处理
- API调用失败重试
- 详细的错误信息输出
- 数据验证和清理

### 3. 数据质量保证
- 数据完整性检查
- 时间格式标准化
- 数值类型转换
- 重复数据去重

## 使用建议

### 1. 首次使用
```bash
# 先测试获取股票代码列表
python baostock_data_collector_fixed.py
# 选择3：仅获取股票代码列表
```

### 2. 数据采集
```bash
# 采集指定股票数据
python baostock_data_collector_fixed.py
# 选择2：采集指定股票数据
# 输入股票代码，如：sh.600000
```

### 3. 批量采集
```bash
# 采集所有股票数据（需要较长时间）
python baostock_data_collector_fixed.py
# 选择1：采集所有股票数据
```

## 数据存储结构

每个股票对应一个SQLite数据库文件：
```
gupiao_baostock/
├── sh.600000_data.db
├── sh.600001_data.db
└── ...
```

每个数据库包含以下表：
- `daily_data`: 日线数据
- `weekly_data`: 周线数据
- `monthly_data`: 月线数据

## 注意事项

1. **API限制**：BaoStock API不支持季度和年K线数据
2. **数据范围**：日、周、月K线从1990年至今
3. **复权选择**：当前使用不复权数据，可根据需要调整
4. **网络要求**：需要稳定的网络连接
5. **存储空间**：大量历史数据会占用较多磁盘空间

## 技术支持

- **BaoStock官网**：http://baostock.com
- **QQ交流群**：931781053
- **邮箱联系**：baostock@163.com 